(function(n,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=n.document?t(n,!0):function(n){if(!n.document)throw new Error("Avalon requires a window with a document");return t(n)}:t(n)})(typeof window!="undefined"?window:this,function(n,t){function u(){n.console&&avalon.config.debug&&Function.apply.call(console.log,console,arguments)}function h(){}function ht(n,t){var r,u,i,f;for(typeof n=="string"&&(n=n.match(l)||[]),r={},u=t!==void 0?t:1,i=0,f=n.length;i<f;i++)r[n[i]]=u;return r}function po(){if(n.VBArray){var t=document.documentMode;return t?t:n.XMLHttpRequest?7:6}return 0}function cu(n){return vo.test(vt.call(n))}function vu(n,t){return n=Math.floor(n)||0,n<0?Math.max(t+n,0):Math.min(n,t)}function wo(n){var t,i;if(!n)return!1;if(t=n.length,t===t>>>0){if(i=vt.call(n).slice(8,-1),/(?:regexp|string|function|window|global)$/i.test(i))return!1;if(i==="Array")return!0;try{return{}.propertyIsEnumerable.call(n,"length")===!1?/^\s?function/.test(n.item||n.callee):!0}catch(r){return!n.window}}return!1}function ti(n,t,i){var r="for(var "+n+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+i;return Function("fn,scope",r)}function wu(n,t){try{while(t=t.parentNode)if(t===n)return!0;return!1}catch(i){return!1}}function bu(){return(new XMLSerializer).serializeToString(this)}function ns(n){var t={},f,e,u,r;for(f in n)t[f]=n[f];return e=t.target=n.srcElement,n.type.indexOf("key")===0?t.which=n.charCode!=null?n.charCode:n.keyCode:ku.test(n.type)&&(u=e.ownerDocument||i,r=u.compatMode==="BackCompat"?u.body:u.documentElement,t.pageX=n.clientX+(r.scrollLeft>>0)-(r.clientLeft>>0),t.pageY=n.clientY+(r.scrollTop>>0)-(r.clientTop>>0),t.wheelDeltaY=t.wheelDelta,t.wheelDeltaX=0),t.timeStamp=new Date-0,t.originalEvent=n,t.preventDefault=function(){n.returnValue=!1},t.stopPropagation=function(){n.cancelBubble=!0},t}function r(n){var t,i;for(t in n)it.call(n,t)&&(i=n[t],typeof r.plugins[t]=="function"?r.plugins[t](i):typeof r[t]=="object"?avalon.mix(r[t],i):r[t]=i);return this}function rf(n){return(n+"").replace(tf,"\\$&")}function ft(n,t,i){var a,o,h,r,u,f,e;if(Array.isArray(n))return a=n.concat(),n.length=0,o=cs(n),o.pushArray(a),o;if(!n||n.nodeType>0||n.$id&&n.$events)return n;h=Array.isArray(n.$skipArray)?n.$skipArray:[];h.$special=t||{};r={};i=i||{};var v={},c={},l=[];ef.forEach(function(t){delete n[t]});for(u in n)(function(n,t,r){if(i[n]=t,ss(n,t,h)){v[n]=[];var u=avalon.type(t);u==="object"&&ct(t.get)&&Object.keys(t).length<=2?(r=rs(n,t),l.push(r)):su.test(u)?(r=us(n,t,u),l.push(function(){var t=r._vmodel;t.$events[k]=this.$events[n]})):r=is(n,t);c[n]=r}})(u,n[u]);r=si(r,of(c),n);for(f in n)c[f]||(r[f]=n[f]);r.$id=d();r.$model=i;r.$events=v;for(u in ri)e=ri[u],s||(e=e.bind(r)),r[u]=e;return ir?Object.defineProperty(r,"hasOwnProperty",{value:function(n){return n in this.$model},writable:!1,enumerable:!1,configurable:!0}):r.hasOwnProperty=function(n){return n in r.$model},l.forEach(function(n){n.call(r)}),r}function is(n,t){function i(n){var t=i._value;return arguments.length>0?gt?this:(rr(n,t)||(i.updateValue(this,n),i.notify(this,n,t)),this):(et.collectDependency(this,i),t)}return hi(i,n),i._value=t,i}function rs(n,t){function i(n){var r=i._value,f="_value"in i,t,u;if(arguments.length>0)return gt?this:(i.set.call(this,n),this);et.collectDependency(this,i);i.digest||(t=this,i.digest=function(){i.updateValue=es;i.notify=h;i.call(t);clearTimeout(u);u=setTimeout(function(){hi(i,i._name);i.call(t)})});et.begin({callback:function(n,t){var u=t._name,r;t!==i&&(r=n.$events[u],or(r,i.digest))}});try{n=i.get.call(this)}finally{et.end()}return r!==n&&(i.updateValue(this,n),f&&i.notify(this,n,r)),n}return t.set=t.set||h,i.set=t.set||h,i.get=t.get,hi(i,n),i}function us(n,t,i){function r(t){var h=r._value,u=r._vmodel,o,s,f;return arguments.length>0?gt?this:(i==="array"?(o=u._,u._=[],u.clear(),u._=o,u.pushArray(t)):i==="object"&&(s=u.$proxy,f=this.$events[n]||[],u=r._vmodel=ft(t),u.$proxy=s,f.length&&(f.forEach(function(n){n.rollback&&(n.rollback(),e[n.type](n,n.vmodels))}),u.$events[n]=f)),r.updateValue(this,u.$model),r.notify(this,this._value,h),this):(et.collectDependency(this,r),u)}return hi(r,n),r._vmodel=ft(t),r}function fs(n,t){n.$model[this._name]=this._value=t}function es(n,t){n.$model[this._name]=t}function os(n,t,i){var r=this._name,u=n.$events[r];u&&(sr(u),ri.$fire.call(n,r,t,i))}function hi(n,t){n._name=t;n.updateValue=fs;n.notify=os}function ss(n,t,i){if(ct(t)||t&&t.nodeType||i.indexOf(n)!==-1)return!1;var r=i.$special;return n&&n.charAt(0)==="$"&&!r[n]?!1:!0}function cs(n){var t=[],i;t.$id=d();t.$model=n;t.$events={};t.$events[k]=[];t._=ft({length:n.length});t._.$watch("length",function(n,i){t.$fire("length",n,i)});for(i in ri)t[i]=ri[i];return t.$map={el:1},t.$proxy=[],avalon.mix(t,fr),t}function wt(n,t,i,r,u,f,e){for(var y=this.length,h=2,s,c,o,l,a,v;--h;){switch(n){case"add":for(s=t+i,c=this.$model.slice(t,s).map(function(n){return su.test(avalon.type(n))?n.$id?n:ft(n,0,n):n}),ci.apply(this,[t,0].concat(c)),o=t;o<s;o++)l=hf(o,this),this.$proxy.splice(o,0,l);this._fire("add",t,i);break;case"del":a=this._splice(t,i);v=this.$proxy.splice(t,i);uo(v,"each");this._fire("del",t,i)}u&&(n=u,t=f,i=e,h=2,u=0)}return sf(this.$proxy,r),this.length!==y&&(this._.length=this.length),a}function sf(n,t){for(var r=n.length-1,i;i=n[t];t++)i.$index=t,i.$first=t===0,i.$last=t===r}function er(n,t){for(var r,u={},i=0,f=t.length;i<f;i++)u[i]=n[i],r=t[i],r in u?(n[i]=u[r],delete u[r]):n[i]=n[r]}function ls(){var t={$index:NaN,$first:NaN,$last:NaN,$map:{},$host:{},$outer:{},$remove:avalon.noop,el:{get:function(){var n=this.$events,t=n.$index;n.$index=n.el;try{return this.$host[this.$index]}finally{n.$index=t}},set:function(n){this.$host.set(this.$index,n)}}},n=ft(t,{$last:1,$first:1,$index:1});return n.$id=d("$proxy$each"),n}function hf(n,t){var i=li.shift(),r;return i||(i=ls()),r=t.length-1,i.$host=t,i.$index=n,i.$first=n===0,i.$last=n===r,i.$map=t.$map,i.$remove=function(){return t.removeAt(i.$index)},i}function or(n,t){t=t||yo[g];n&&t&&avalon.Array.ensure(n,t)&&t.element&&yf(t,n)}function sr(n){var r,u,t,i,f;if(n&&n.length)for(new Date-lf>444&&typeof n[0]=="object"&&pf(),r=bi.call(arguments,1),u=n.length;t=n[--u];)i=t.element,i&&i.parentNode&&(t.$repeat?t.handler.apply(t,r):t.type!=="on"&&(f=t.evaluator||h,t.handler(f.apply(0,t.args||[]),i,t)))}function vf(n){return n.uniqueNumber||(n.uniqueNumber=++as)}function yf(n,t){var i=n.element,r;n.uuid||(n.uuid=i.nodeType!==1?n.type+(n.pos||0)+"-"+vf(i.parentNode):n.name+"-"+vf(i));r=n.lists||(n.lists=[]);avalon.Array.ensure(r,t);t.$uuid=t.$uuid||d();ot[n.uuid]||(ot[n.uuid]=1,ot.push(n))}function pf(n){for(var t=ot.length,c=t,o=[],s={},i={},r,u,f,h,e;n=ot[--t];)r=n.type,i[r]?i[r]++:(i[r]=1,o.push(r));if(u=!1,o.forEach(function(n){af[n]!==i[n]&&(s[n]=1,u=!0)}),t=c,u)while(n=ot[--t])if(n.element&&s[n.type]&&vs(n.element)){for(ot.splice(t,1),delete ot[n.uuid],f=n.lists,h=0;e=f[h++];)avalon.Array.remove(f,e),avalon.Array.remove(e,n);wf(n)}af=i;lf=new Date}function wf(n){n.element=null;n.rollback&&n.rollback();for(var t in n)n[t]=null}function vs(n){try{if(!n.parentNode)return!0}catch(t){return!0}return n.msRetain?0:n.nodeType===1?!v.contains(n):!avalon.contains(v,n)}function kf(n){var t=n.nodeName;return t.toLowerCase()===t&&n.scopeName&&n.outerText===""}function gs(n){n.currentStyle.behavior!=="url(#default#VML)"&&(n.style.behavior="url(#default#VML)",n.style.display="inline-block",n.style.zoom=1)}function df(n){return n.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function ai(n){return!n||n.indexOf("-")<0&&n.indexOf("_")<0?n:n.replace(/[-_][^-_]/g,function(n){return n.charAt(1).toUpperCase()})}function gf(n){if(!("classList"in n)){n.classList={node:n};for(var t in hr)n.classList[t.slice(1)]=hr[t]}return n.classList}function ne(n){try{if(typeof n=="object")return n;n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:nh.test(n)?avalon.parseJSON(n):n}catch(t){}return n}function fh(n){return n.window&&n.document?n:n.nodeType===9?n.defaultView||n.parentWindow:!1}function ue(n,t){var u,i,r;if(n.offsetWidth<=0){if(re.test(o["@:get"](n,"display"))){u={node:n};for(i in ar)u[i]=n.style[i],n.style[i]=ar[i];t.push(u)}r=n.parentNode;r&&r.nodeType===1&&ue(r,t)}}function ch(n){var t=n.tagName.toLowerCase();return t==="input"&&/checkbox|radio/.test(n.type)?"checked":t}function gh(n,t,i,r){for(var f,e=[],s=" = "+i+".",h=/\$proxy\$each/.test(t.$id),o=n.length,u;u=n[--o];)f=h&&t.$map[u]?"el":u,t.hasOwnProperty(f)&&(e.push(u+s+f),r.vars.push(u),r.type==="duplex"&&(n.get=i+"."+f),n.splice(o,1));return e}function oe(n){for(var t,r,u=[],f={},i=0;i<n.length;i++)t=n[i],r=t&&typeof t.$id=="string"?t.$id:t,f[r]||(f[r]=u.push(t));return u}function oc(n,t){return t=t.replace(ic,"").replace(rc,function(){return"],|"}).replace(uc,function(n,t){return"["+fe(t)}).replace(fc,function(){return'"],["'}).replace(ec,function(){return'",'})+"]","return avalon.filters.$filter("+n+", "+t+")"}function se(n,t,i){var s=i.type,a=i.filters||"",v=t.map(function(n){return String(n.$id).replace(tc,"$1")})+n+s+a,l=dh(n).concat(),r=[],c=[],p=[],e="",o,w,y,f,b;for(t=oe(t),i.vars=[],o=0,w=t.length;o<w;o++)l.length&&(y="vm"+g+"_"+o,c.push(y),p.push(t[o]),r.push.apply(r,gh(l,t[o],y,i)));if(r.length||s!=="duplex"){if(s!=="duplex"&&(n.indexOf("||")>-1||n.indexOf("&&")>-1)&&i.vars.forEach(function(t){var i=new RegExp("\\b"+t+"(?:\\.\\w+|\\[\\w+\\])+","ig");n=n.replace(i,function(i){var e=i.charAt(t.length),h=nt?n.slice(arguments[1]+i.length):RegExp.rightContext,o=/^\s*\(/.test(h),u,f,s;return e==="."||e==="["||o?(u="var"+String(Math.random()).replace(/^0\./,""),o)?(f=i.split("."),f.length>2?(s=f.pop(),r.push(u+" = "+f.join(".")),u+"."+s):i):(r.push(u+" = "+i),u):i})}),i.args=p,delete i.vars,f=yr.get(v),f){i.evaluator=f;return}if(e=r.join(", "),e&&(e="var "+e),/\S/.test(a)){if(!/text|html/.test(i.type))throw Error("ms-"+i.type+"不支持过滤器");n="\nvar ret"+g+" = "+n+";\r\n"+oc("ret"+g,a)}else{if(s==="duplex"){b="'use strict';\nreturn function(vvv){\n\t"+e+";\n\tif(!arguments.length){\n\t\treturn "+n+"\n\t}\n\t"+(nc.test(n)?n:l.get)+"= vvv;\n} ";try{f=Function.apply(h,c.concat(b));i.evaluator=yr.put(v,f)}catch(k){u("debug: parse error,"+k.message)}return}if(s==="on"){n.indexOf("(")===-1?n+=".call(this, $event)":n=n.replace("(",".call(this,");c.push("$event");n="\nreturn "+n+";";var d=n.lastIndexOf("\nreturn"),tt=n.slice(0,d),it=n.slice(d);n=tt+"\n"+it}else n="\nreturn "+n+";"}try{f=Function.apply(h,c.concat("'use strict';\n"+e+n));i.evaluator=yr.put(v,f)}catch(k){u("debug: parse error,"+k.message)}finally{l=r=c=null}}}function tt(n,t,i,r,u){Array.isArray(r)&&(n=r.map(function(n){return n.expr?"("+n.value+")":fe(n.value)}).join(" + "));se(n,t,i);i.evaluator&&!u&&(i.handler=b[i.handlerName||i.type],avalon.injectBinding(i))}function pr(n,t,i){var r=setTimeout(function(){var u=n.innerHTML;clearTimeout(r);u===i?t():pr(n,t,u)})}function ce(n,t){var i=n.getAttribute("avalonctrl")||t.$id;n.setAttribute("avalonctrl",i);t.$events.expr=n.tagName+'[avalonctrl="'+i+'"]'}function wr(n,t){for(var r=0,i;i=n[r++];)i.vmodels=t,e[i.type](i,t),i.evaluator&&i.element&&i.element.nodeType===1&&i.element.removeAttribute(i.name);n.length=0}function lc(n,t){return n.priority-t.priority}function ve(n,t,i){var p=!0,s,h,f,b,y;if(t.length){var k=be?be(n):n.attributes,o=[],w=[],v={};for(s=0;h=k[s++];)if(h.specified&&(i=h.name.match(ae))){var r=i[1],a=i[2]||"",c=h.value,l=h.name;hc[r]?(a=r,r="on"):cc[r]&&(r==="enabled"&&(u("warning!ms-enabled或ms-attr-enabled已经被废弃"),r="disabled",c="!("+c+")"),a=r,r="attr",l="ms-"+r+a,w.push([h.name,l,c]));v[l]=c;typeof e[r]=="function"&&(f={type:r,param:a,element:n,name:l,value:c,priority:(sc[r]||r.charCodeAt(0)*10)+(Number(a.replace(/\D/g,""))||0)},r==="html"||r==="text"?(b=br(c),avalon.mix(f,b),f.filters=f.filters.replace(de,function(){return f.type="html",f.group=1,""})):r==="duplex"?y=l:l==="ms-if-loop"&&(f.priority+=100),o.push(f),r==="widget"&&(n.msData=n.msData||v))}if(o.length){for(o.sort(lc),w.forEach(function(t){u("warning!请改用"+t[1]+"代替"+t[0]+"!");n.removeAttribute(t[0]);n.setAttribute(t[1],t[2])}),y&&(v["ms-attr-checked"]&&u("warning!一个控件不能同时定义ms-attr-checked与"+y),v["ms-attr-value"]&&u("warning!一个控件不能同时定义ms-attr-value与"+y)),s=0;f=o[s];s++){if(r=f.type,ye.test(r))return wr(o.slice(0,s+1),t);p&&(p=!pe.test(r))}wr(o,t)}}p&&!he[n.tagName]&&nf.test(n.innerHTML.replace(dc,"<").replace(gc,">"))&&(le&&le(n),wc(n,t))}function wc(n,t){var i=avalon.slice(n.childNodes);ui(i,t)}function ui(n,t){for(var r=0,i;i=n[r++];)bc(i,i.nodeType,t)}function bc(n,t,i){t===1?(ke(n,i),n.msCallback&&(n.msCallback(),n.msCallback=void 0)):t===3&&ii.test(n.data)?ge(n,i):r.commentInterpolate&&t===8&&!ii.test(n.nodeValue)&&ge(n,i)}function ke(n,t,i){var s=n.getAttribute("ms-skip"),f,o,r,e;if(!n.getAttributeNode)return u("warning "+n.tagName+" no getAttributeNode method");if(f=n.getAttributeNode("ms-important"),o=n.getAttributeNode("ms-controller"),typeof s!="string"){if(i=f||o){if(r=avalon.vmodels[i.value],!r)return;t=i===f?[r]:[r].concat(t);e=i.name;n.removeAttribute(e);avalon(n).removeClass(e);ce(n,r)}ve(n,t)}}function br(n,t){if(n.indexOf("|")>0){var r=n.replace(nl,function(n){return Array(n.length+1).join("1")}),i=r.replace(kc,"ᄢ㍄").indexOf("|");if(i>-1)return{filters:n.slice(i),value:n.slice(0,i),pos:t||0,expr:!0}}return{value:n,filters:"",expr:!0}}function kr(n){var u=[],t,i=0,r;do{if(r=n.indexOf(rt,i),r===-1)break;if(t=n.slice(i,r),t&&u.push({value:t,filters:"",expr:!1}),i=r+rt.length,r=n.indexOf(ut,i),r===-1)break;t=n.slice(i,r);t&&u.push(br(t,i));i=r+ut.length}while(1);return t=n.slice(i),t&&u.push({value:t,expr:!1,filters:""}),u}function ge(n,t){var f=[],r,u,o,e;if(n.nodeType===8?(r=br(n.nodeValue),u=[r]):u=kr(n.data),u.length){for(o=0;r=u[o++];)e=i.createTextNode(r.value),r.expr&&(r.type="text",r.element=e,r.filters=r.filters.replace(de,function(){return r.type="html",""}),f.push(r)),yt.appendChild(e);n.parentNode.replaceChild(yt,n);f.length&&wr(f,t)}}function rl(n,t,r){var f=n.templateCache&&n.templateCache[t],u,e;if(f){for(u=i.createDocumentFragment();e=f.firstChild;)u.appendChild(e);return u}return avalon.parseHTML(r)}function nu(n){return n==null?"":n}function ul(n,t,i){return t.param.replace(/\w+/g,function(r){var u=avalon.duplexHooks[r];u&&typeof u[i]=="function"&&(n=u[i](n,t))}),n}function fl(){for(var t,n=kt.length-1;n>=0;n--)t=kt[n],t()===!1&&kt.splice(n,1);kt.length||clearInterval(io)}function ro(n,t,i,r){var u=n.template.cloneNode(!0),o=avalon.slice(u.childNodes),f,e;n.$with||u.insertBefore(n.clone.cloneNode(!1),u.firstChild);t.appendChild(u);f=[i].concat(n.vmodels);e={nodes:o,vmodels:f};r.push(e)}function el(n){for(var i=n.element,u=i.nodeValue.replace(":end",""),t=i.previousSibling,r=[];t;)t.nodeValue===u&&r.unshift(t),t=t.previousSibling;return r}function uu(n,t,i){for(;;){var r=t.previousSibling;if(!r)break;if(r.parentNode.removeChild(r),i&&i.call(r),r===n)break}}function ol(){var n=ft({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(n){this.$host[this.$key]=n}}},{$val:1});return n.$id=d("$proxy$with"),n}function sl(n,t,i){n=n||fu.pop();n||(n=ol());var r=i.$repeat;return n.$key=t,n.$host=r,n.$outer=i.$outer,r.$events?n.$events.$val=r.$events[t]:n.$events={},n}function uo(n){n.forEach(function(n){fo(n,li)});n.length=0}function fo(n,t){for(var i in n.$events)Array.isArray(n.$events[i])&&(n.$events[i].forEach(function(n){typeof n=="object"&&wf(n)}),n.$events[i].length=0);n.$host=n.$outer={};t.unshift(n)>r.maxRepeatSize&&t.pop()}function fi(n,t){var u="_"+n,r;return fi[u]||(r=i.createElement(n),v.appendChild(r),t=s?getComputedStyle(r,null).display:r.currentStyle.display,v.removeChild(r),fi[u]=t),fi[u]}function eo(n,t,i,r){n=(n+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+n)?+n:0,f=isFinite(+t)?Math.abs(t):3,o=r||",",s=i||".",u="",h=function(n,t){var i=Math.pow(10,t);return""+(Math.round(n*i)/i).toFixed(t)};return u=(f?h(e,f):""+Math.round(e)).split("."),u[0].length>3&&(u[0]=u[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(u[1]||"").length<f&&(u[1]=u[1]||"",u[1]+=new Array(f-u[1].length+1).join("0")),u.join(s)}function so(){try{v.doScroll("left");dt()}catch(n){setTimeout(so)}}var g=new Date-0,i=n.document,p=i.getElementsByTagName("head")[0],st=p.insertBefore(document.createElement("avalon"),p.firstChild),yi,d,nt,ct,lu,au,e,b,ei,yu,ki,di,ku,pt,nr,du,rt,ut,ii,gu,nf,tf,oi,si,rr,of,ur,ci,fr,li,et,cf,y,hr,ar,re,he,bt,ye,pe,no,dr,vi,to,at,io,kt,tu,iu,ru,fu,eu,f,ou,oo,dt,ho,co;st.innerHTML="X<style id='avalonStyle'>.avalonHide{ display: none!important }<\/style>";st.setAttribute("ms-skip","1");st.className="avalonHide";yi=/\[native code\]/;var k="$"+g,lo=n.require,ao=n.define,c,gt=!1,l=/[^, ]+/g,su=/^(?:object|array)$/,pi=/^\[object SVG\w*Element\]$/,vo=/^\[object (?:Window|DOMWindow|global)\]$/,wi=Object.prototype,it=wi.hasOwnProperty,vt=wi.toString,w=Array.prototype,bi=w.slice,yo={},s=n.dispatchEvent,v=i.documentElement,yt=i.createDocumentFragment(),ni=i.createElement("div"),hu={};"Boolean Number String Function Array Date RegExp Object Error".replace(l,function(n){hu["[object "+n+"]"]=n.toLowerCase()});d=function(n){return n=n||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,n)};nt=po();avalon=function(n){return new avalon.init(n)};avalon.nextTick=new function(){function f(){for(var i=t.length,n=0;n<i;n++)t[n]();t=t.slice(i)}var r=n.setImmediate,u=n.MutationObserver,e=s&&n.postMessage,t,i;return r?r.bind(n):(t=[],u)?(i=document.createTextNode("avalon"),new u(f).observe(i,{characterData:!0}),function(n){t.push(n);i.data=Math.random()}):e?(n.addEventListener("message",function(t){var i=t.source;(i===n||i===null)&&t.data==="process-tick"&&(t.stopPropagation(),f())}),function(i){t.push(i);n.postMessage("process-tick","*")}):function(n){setTimeout(n,0)}};avalon.init=function(n){this[0]=this.element=n};avalon.fn=avalon.prototype=avalon.init.prototype;avalon.type=function(n){return n==null?String(n):typeof n=="object"||typeof n=="function"?hu[vt.call(n)]||"object":typeof n};ct=typeof alert=="object"?function(n){try{return/^\s*\bfunction\b/.test(n+"")}catch(t){return!1}}:function(n){return vt.call(n)==="[object Function]"};avalon.isFunction=ct;avalon.isWindow=function(n){return n?n==n.document&&n.document!=n:!1};cu(n)&&(avalon.isWindow=cu);for(lu in avalon({}))break;au=lu!=="0";avalon.isPlainObject=function(n,t){if(!n||avalon.type(n)!=="object"||n.nodeType||avalon.isWindow(n))return!1;try{if(n.constructor&&!it.call(n,"constructor")&&!it.call(n.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(au)for(t in n)return it.call(n,t);for(t in n);return t===void 0||it.call(n,t)};yi.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(n){return vt.call(n)==="[object Object]"&&Object.getPrototypeOf(n)===wi});avalon.mix=avalon.fn.mix=function(){var f,u,i,t,e,o,n=arguments[0]||{},r=1,h=arguments.length,s=!1;for(typeof n=="boolean"&&(s=n,n=arguments[1]||{},r++),typeof n=="object"||ct(n)||(n={}),r===h&&(n=this,r--);r<h;r++)if((f=arguments[r])!=null)for(u in f){i=n[u];try{t=f[u]}catch(c){continue}n!==t&&(s&&t&&(avalon.isPlainObject(t)||(e=Array.isArray(t)))?(e?(e=!1,o=i&&Array.isArray(i)?i:[]):o=i&&avalon.isPlainObject(i)?i:{},n[u]=avalon.mix(s,o,t)):t!==void 0&&(n[u]=t))}return n};avalon.mix({rword:l,subscribers:k,version:1.44,ui:{},log:u,slice:s?function(n,t,i){return bi.call(n,t,i)}:function(n,t,i){var f=[],u=n.length,r;if(i===void 0&&(i=u),typeof i=="number"&&isFinite(i))for(t=vu(t,u),i=vu(i,u),r=t;r<i;++r)f[r-t]=n[r];return f},noop:h,error:function(n,t){throw(t||Error)(n);},oneObject:ht,range:function(n,t,i){i||(i=1);t==null&&(t=n||0,n=0);for(var r=-1,u=Math.max(0,Math.ceil((t-n)/i)),f=new Array(u);++r<u;)f[r]=n,n+=i;return f},eventHooks:{},bind:function(n,t,i,r){var e=avalon.eventHooks,u=e[t],f;return typeof u=="object"&&(t=u.type,u.deel&&(i=u.deel(n,t,i,r))),f=s?i:function(t){i.call(n,ns(t))},s?n.addEventListener(t,f,!!r):n.attachEvent("on"+t,f),f},unbind:function(n,t,i,r){var e=avalon.eventHooks,u=e[t],f=i||h;typeof u=="object"&&(t=u.type,u.deel&&(i=u.deel(n,t,i,!1)));s?n.removeEventListener(t,f,!!r):n.detachEvent("on"+t,f)},css:function(n,t,i){var r,u,f;if(n instanceof avalon&&(n=n[0]),r=/[_-]/.test(t)?ai(t):t,t=avalon.cssName(r)||r,i===void 0||typeof i=="boolean")return u=o[r+":get"]||o["@:get"],t==="background"&&(t="backgroundColor"),f=u(n,t),i===!0?parseFloat(f)||0:f;if(i==="")n.style[t]="";else{if(i==null||i!==i)return;isFinite(i)&&!avalon.cssNumber[r]&&(i+="px");u=o[r+":set"]||o["@:set"];u(n,t,i)}},each:function(n,t){var i,r;if(n)if(i=0,wo(n)){for(r=n.length;i<r;i++)if(t(i,n[i])===!1)break}else for(i in n)if(n.hasOwnProperty(i)&&t(i,n[i])===!1)break},getWidgetData:function(n,t){var r=avalon(n).data(),u={};for(var i in r)i.indexOf(t)===0&&(u[i.replace(t,"").replace(/\w/,function(n){return n.toLowerCase()})]=r[i]);return u},Array:{ensure:function(n,t){if(n.indexOf(t)===-1)return n.push(t)},removeAt:function(n,t){return!!n.splice(t,1).length},remove:function(n,t){var i=n.indexOf(t);return~i?avalon.Array.removeAt(n,i):!1}}});e=avalon.bindingHandlers={};b=avalon.bindingExecutors={};ei=new function(){function t(n){this.size=0;this.limit=n;this.head=this.tail=void 0;this._keymap={}}var n=t.prototype;return n.put=function(n,t){var i={key:n,value:t};return this._keymap[n]=i,this.tail?(this.tail.newer=i,i.older=this.tail):this.head=i,this.tail=i,this.size===this.limit?this.shift():this.size++,t},n.shift=function(){var n=this.head;n&&(this.head=this.head.newer,this.head.older=n.newer=n.older=this._keymap[n.key]=void 0)},n.get=function(n){var t=this._keymap[n];if(t!==void 0)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},t};"司徒正美".trim||(yu=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,String.prototype.trim=function(){return this.replace(yu,"")});var bo=!{toString:null}.propertyIsEnumerable("toString"),ko=function(){}.propertyIsEnumerable("prototype"),pu=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],go=pu.length;if(Object.keys||(Object.keys=function(n){var t=[],s=ko&&typeof n=="function",i,r,e,o,u,f;if(typeof n=="string"||n&&n.callee)for(i=0;i<n.length;++i)t.push(String(i));else for(r in n)s&&r==="prototype"||!it.call(n,r)||t.push(String(r));if(bo)for(e=n.constructor,o=e&&e.prototype===n,u=0;u<go;u++)f=pu[u],o&&f==="constructor"||!it.call(n,f)||t.push(f);return t}),Array.isArray||(Array.isArray=function(n){return vt.call(n)==="[object Array]"}),h.bind||(Function.prototype.bind=function(n){if(arguments.length<2&&n===void 0)return this;var i=this,t=arguments;return function(){for(var u=[],r=1;r<t.length;r++)u.push(t[r]);for(r=0;r<arguments.length;r++)u.push(arguments[r]);return i.apply(n,u)}}),yi.test([].map)||avalon.mix(w,{indexOf:function(n,t){var r=this.length,i=~~t;for(i<0&&(i+=r);i<r;i++)if(this[i]===n)return i;return-1},lastIndexOf:function(n,t){var r=this.length,i=t==null?r-1:t;for(i<0&&(i=Math.max(0,r+i));i>=0;i--)if(this[i]===n)return i;return-1},forEach:ti("","_",""),filter:ti("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:ti("r=[],","r[i]=_","return r"),some:ti("","if(_)return true","return false"),every:ti("","if(!_)return false","return true")}),avalon.contains=wu,i.contains||(i.contains=function(n){return wu(i,n)}),n.SVGElement&&(i.createTextNode("x").contains||(Node.prototype.contains=function(n){return!!(this.compareDocumentPosition(n)&16)}),ki="http://www.w3.org/2000/svg",di=i.createElementNS(ki,"svg"),di.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',!pi.test(di.firstChild))){function gi(n,t){var f,e,r,u;if(n&&n.childNodes)for(f=n.childNodes,e=0;r=f[e++];)r.tagName&&(u=i.createElementNS(ki,r.tagName.toLowerCase()),w.forEach.call(r.attributes,function(n){u.setAttribute(n.name,n.value)}),gi(r,u),t.appendChild(u))}Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:bu,set:function(n){var f=this.tagName.toLowerCase(),t=this.parentNode,u=avalon.parseHTML(n),r;f==="svg"?t.insertBefore(u,this):(r=i.createDocumentFragment(),gi(u,r),t.insertBefore(r,this));t.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var n=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),i=new RegExp("<\/"+this.nodeName+">$","i");return n.replace(t,"").replace(i,"")},set:function(n){if(avalon.clearHTML){avalon.clearHTML(this);var t=avalon.parseHTML(n);gi(t,this)}}}})}!v.outerHTML&&n.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",bu);ku=/^(?:mouse|contextmenu|drag)|click/;pt=avalon.eventHooks;"onmouseenter"in v||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(n,t){pt[n]={type:t,deel:function(t,i,r){return function(i){var u=i.relatedTarget;if(!u||u!==t&&!(t.compareDocumentPosition(u)&16))return delete i.type,i.type=n,r.call(t,i)}}}});avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(t,i){n[t]&&!pt.animationend&&(pt.animationend={type:i})});"oninput"in i.createElement("input")||(pt.input={type:"propertychange",deel:function(n,t,i){return function(t){if(t.propertyName==="value")return t.type="input",i.call(n,t)}}});i.onmousewheel===void 0&&(nr=i.onwheel!==void 0?"wheel":"DOMMouseScroll",du=nr==="wheel"?"deltaY":"detail",pt.mousewheel={type:nr,deel:function(n,t,i){return function(t){t.wheelDeltaY=t.wheelDelta=t[du]>0?-120:120;t.wheelDeltaX=0;Object.defineProperty&&Object.defineProperty(t,"type",{value:"mousewheel"});i.call(n,t)}}});tf=/[-.*+?^${}()|[\]\/\\]/g;oi={loader:function(t){var i=c&&t;n.require=i?c:lo;n.define=i?c.define:ao},interpolate:function(n){var u,t,i;if(rt=n[0],ut=n[1],rt===ut)throw new SyntaxError("openTag!==closeTag");else if(n+""=="<!--,-->")r.commentInterpolate=!0;else{if(u=rt+"test"+ut,ni.innerHTML=u,ni.innerHTML!==u&&ni.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");ni.innerHTML=""}t=rf(rt);i=rf(ut);ii=new RegExp(t+"(.*?)"+i);gu=new RegExp(t+"(.*?)"+i,"g");nf=new RegExp(t+".*?"+i+"|\\sms-")}};r.debug=!0;r.plugins=oi;r.plugins.interpolate(["{{","}}"]);r.paths={};r.shim={};r.maxRepeatSize=100;avalon.config=r;var ts=/(\w+)\[(avalonctrl)="(\S+)"\]/,uf=i.querySelectorAll?function(n){return i.querySelectorAll(n)}:function(n){for(var t=n.match(ts),f=i.getElementsByTagName(t[1]),u=[],e=0,r;r=f[e++];)r.getAttribute(t[2])===t[3]&&u.push(r);return u},ri={$watch:function(n,t){if(typeof t=="function"){var i=this.$events[n];i?i.push(t):this.$events[n]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(n,t){var u=arguments.length,i,r;if(u===0)this.$watch.backup=this.$events,this.$events={};else if(u===1)this.$events[n]=[];else for(i=this.$events[n]||[],r=i.length;~--r<0;)if(i[r]===t)return i.splice(r,1);return this},$fire:function(n){var f,t,r,u,e,s,h,c,l,a,o,v,y;if(/^(\w+)!(\S+)$/.test(n)&&(f=RegExp.$1,n=RegExp.$2),e=this.$events,e)if(s=bi.call(arguments,1),h=[n].concat(s),f==="all")for(t in avalon.vmodels)r=avalon.vmodels[t],r!==this&&r.$fire.apply(r,h);else if(f==="up"||f==="down"){if(c=e.expr?uf(e.expr):[],c.length===0)return;for(t in avalon.vmodels)if(r=avalon.vmodels[t],r!==this&&r.$events.expr){if(l=uf(r.$events.expr),l.length===0)continue;w.forEach.call(l,function(n){w.forEach.call(c,function(t){var i=f==="down"?t.contains(n):n.contains(t);i&&(n._avalon=r)})})}for(a=i.getElementsByTagName("*"),o=[],w.forEach.call(a,function(n){n._avalon&&(o.push(n._avalon),n._avalon="",n.removeAttribute("_avalon"))}),f==="up"&&o.reverse(),t=0;u=o[t++];)if(u.$fire.apply(u,h)===!1)break}else{for(v=e[n]||[],y=e.$all||[],t=0;u=v[t++];)ct(u)&&u.apply(this,s);for(t=0;u=y[t++];)ct(u)&&u.apply(this,arguments)}}},ff=avalon.vmodels={};avalon.define=function(n,t){var i=n.$id||n,r,f;return i||u("warning: vm必须指定$id"),ff[i]&&u("warning: "+i+" 已经存在于avalon.vmodels中"),typeof n=="object"?r=ft(n):(f={$watch:h},t(f),r=ft(f),gt=!0,t(r),gt=!1),r.$id=i,ff[i]=r};var ef=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$proxy").match(l),tr=Object.defineProperty,ir=!0;try{tr({},"_",{value:"x"});si=Object.defineProperties}catch(wl){ir=!1}if(rr=Object.is||function(n,t){return n===0&&t===0?1/n==1/t:n!==n?t!==t:n===t},of=s?function(n){var i={};for(var t in n)i[t]={get:n[t],set:n[t],enumerable:!0,configurable:!0};return i}:function(n){return n},!ir&&("__defineGetter__"in avalon&&(tr=function(n,t,i){return"value"in i&&(n[t]=i.value),"get"in i&&n.__defineGetter__(t,i.get),"set"in i&&n.__defineSetter__(t,i.set),n},si=function(n,t){for(var i in t)t.hasOwnProperty(i)&&tr(n,i,t[i]);return n}),nt)){ur={};n.execScript("Function parseVB(code)\n\tExecuteGlobal(code)\nEnd Function","VBScript");function hs(n,t,i,r){var u=t[i];if(arguments.length===4)u.call(n,r);else return u.call(n)}si=function(t,i,r){var f=[],e,u;f.push("\r\n\tPrivate [__data__], [__proxy__]","\tPublic Default Function [__const__](d, p)","\t\tSet [__data__] = d: set [__proxy__] = p","\t\tSet [__const__] = Me","\tEnd Function");for(t in r)i.hasOwnProperty(t)||f.push("\tPublic ["+t+"]");ef.forEach(function(n){i.hasOwnProperty(n)||f.push("\tPublic ["+n+"]")});f.push("\tPublic [hasOwnProperty]");for(t in i)f.push("\tPublic Property Let ["+t+"](val"+g+")",'\t\tCall [__proxy__](Me,[__data__], "'+t+'", val'+g+")","\tEnd Property","\tPublic Property Set ["+t+"](val"+g+")",'\t\tCall [__proxy__](Me,[__data__], "'+t+'", val'+g+")","\tEnd Property","\tPublic Property Get ["+t+"]","\tOn Error Resume Next","\t\tSet["+t+'] = [__proxy__](Me,[__data__],"'+t+'")',"\tIf Err.Number <> 0 Then","\t\t["+t+'] = [__proxy__](Me,[__data__],"'+t+'")',"\tEnd If","\tOn Error Goto 0","\tEnd Property");return f.push("End Class"),e=f.join("\r\n"),u=ur[e],u||(u=d("VBClass"),n.parseVB("Class "+u+e),n.parseVB(["Function "+u+"Factory(a, b)","\tDim o","\tSet o = (New "+u+")(a, b)","\tSet "+u+"Factory = o","End Function"].join("\r\n")),ur[e]=u),n[u+"Factory"](i,hs)}}ci=w.splice;fr={_splice:ci,_fire:function(n,t,i){sr(this.$events[k],n,t,i)},size:function(){return this._.length},pushArray:function(n){var t=n.length,i=this.length;return t&&(w.push.apply(this.$model,n),wt.call(this,"add",i,t,Math.max(0,i-1))),t+i},push:function(){for(var t=[],i=arguments.length,n=0;n<i;n++)t[n]=arguments[n];return this.pushArray(t)},unshift:function(){var n=arguments.length,t=this.length;return n&&(w.unshift.apply(this.$model,arguments),wt.call(this,"add",0,n,0)),n+t},shift:function(){if(this.length){var n=this.$model.shift();return wt.call(this,"del",0,1,0),n}},pop:function(){var n=this.length,t;if(n)return t=this.$model.pop(),wt.call(this,"del",n-1,1,Math.max(0,n-2)),t},splice:function(n){var r=arguments.length,t=[],i,u=ci.apply(this.$model,arguments);return u.length&&(t.push("del",n,u.length,0),i=!0),r>2&&(i?t.splice(3,1,0,"add",n,r-2):t.push("add",n,r-2,0),i=!0),i?wt.apply(this,t):[]},contains:function(n){return this.indexOf(n)!==-1},remove:function(n){return this.removeAt(this.indexOf(n))},removeAt:function(n){return n>=0?(this.$model.splice(n,1),wt.call(this,"del",n,1,0)):[]},clear:function(){return uo(this.$proxy,"each"),this.$model.length=this.$proxy.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(n){if(Array.isArray(n))for(var t=this.length-1;t>=0;t--)n.indexOf(this[t])!==-1&&this.removeAt(t);else if(typeof n=="function")for(t=this.length-1;t>=0;t--)n(this[t],t)&&this.removeAt(t);else this.clear()},ensure:function(n){return this.contains(n)||this.push(n),this},set:function(n,t){var u,i,r,f;if(n>=0)if(u=avalon.type(t),t&&t.$model&&(t=t.$model),i=this[n],u==="object")for(r in t)i.hasOwnProperty(r)&&(i[r]=t[r]);else u==="array"?i.clear().push.apply(i,t):i!==t&&(this[n]=t,this.$model[n]=t,f=this.$proxy[n],f&&sr(f.$events.el));return this}};"sort,reverse".replace(l,function(n){fr[n]=function(){var u=this.$model,r=u.concat(),c=Math.random(),i=[],o,t,s,f,h,e;for(w[n].apply(u,arguments),t=0,s=r.length;t<s;t++)f=u[t],h=r[t],rr(f,h)?i.push(t):(e=r.indexOf(f),i.push(e),r[e]=c,o=!0);return o&&(er(this,i),er(this.$proxy,i),this._fire("move",i),sf(this.$proxy,0)),this}});li=[];et=function(){var t=[],n;return{begin:function(i){t.push(n);n=i},end:function(){n=t.pop()},collectDependency:function(t,i){n&&n.callback(t,i)}}}();cf=/^(duplex|on)$/avalon.injectBinding=function(n){var u=n.evaluator,f,t,e;if(u){et.begin({callback:function(t,i){or(t.$events[i._name],n)}});try{f=cf.test(n.type)?n:u.apply(0,n.args);n.handler(f,n.element,n)}catch(o){delete n.evaluator;t=n.element;t.nodeType===3&&(e=t.parentNode,r.commentInterpolate?e.replaceChild(i.createComment(n.value),t):t.data=rt+n.value+ut)}finally{et.end()}}};var as=0,ot=avalon.$$subscribers=[],lf=new Date,af={};y={area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],col:[2,"<table><colgroup>","<\/colgroup><\/table>"],legend:[1,"<fieldset>","<\/fieldset>"],option:[1,"<select multiple='multiple'>","<\/select>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table>","<\/table>"],td:[3,"<table><tr>","<\/tr><\/table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"<\/svg>"],_default:s?[0,"",""]:[1,"X<div>","<\/div>"]};y.th=y.td;y.optgroup=y.option;y.tbody=y.tfoot=y.colgroup=y.caption=y.thead;String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(l,function(n){y[n]=y.g});var ys=/<([\w:]+)/,ps=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,bf=s?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/ig,ws=ht(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),bs=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,ks=i.createElement("script"),ds=/<|&#?\w+;/avalon.parseHTML=function(n){var e=yt.cloneNode(!1),r,f,t,h,v;if(typeof n!="string")return e;if(!ds.test(n))return e.appendChild(i.createTextNode(n)),e;n=n.replace(ps,"<$1><\/$2>").trim();var l=(ys.exec(n)||["",""])[1].toLowerCase(),c=y[l]||y._default,u=ni,a,o;if(s||(n=n.replace(bf,"<br class=msNoScope>$1")),u.innerHTML=c[1]+n+c[2],r=u.getElementsByTagName("script"),r.length)for(f=0;t=r[f++];)ws[t.type]&&(o=ks.cloneNode(!1),w.forEach.call(t.attributes,function(n){n&&n.specified&&(o[n.name]=n.value,o.setAttribute(n.name,n.value))}),o.text=t.text,t.parentNode.replaceChild(o,t));if(!s){if(h=c[1]==="X<div>"?u.lastChild.firstChild:u.lastChild,h&&h.tagName==="TABLE"&&l!=="tbody")for(r=h.childNodes,f=0;t=r[f++];)if(t.tagName==="TBODY"&&!t.innerHTML){h.removeChild(t);break}for(r=u.getElementsByTagName("br"),v=r.length;t=r[--v];)t.className==="msNoScope"&&t.parentNode.removeChild(t);for(r=u.all,f=0;t=r[f++];)kf(t)&&gs(t)}for(f=c[0];f--;u=u.lastChild);while(a=u.firstChild)e.appendChild(a);return e};avalon.innerHTML=function(n,t){if(!s&&!bf.test(t)&&!bs.test(t))try{n.innerHTML=t;return}catch(r){}var i=this.parseHTML(t);this.clearHTML(n).appendChild(i)};avalon.clearHTML=function(n){for(n.textContent="";n.firstChild;)n.removeChild(n.firstChild);return n};hr={_toString:function(){var t=this.node,n=t.className,i=typeof n=="string"?n:n.baseVal;return i.split(/\s+/).join(" ")},_contains:function(n){return(" "+this+" ").indexOf(" "+n+" ")>-1},_add:function(n){this.contains(n)||this._set(this+" "+n)},_remove:function(n){this._set((" "+this+" ").replace(" "+n+" "," "))},__set:function(n){n=n.trim();var t=this.node;pi.test(t)?t.setAttribute("class",n):t.className=n}};"add,remove".replace(l,function(n){avalon.fn[n+"Class"]=function(t){var i=this[0];return t&&typeof t=="string"&&i&&i.nodeType===1&&t.replace(/\S+/g,function(t){gf(i)[n](t)}),this}});avalon.fn.mix({hasClass:function(n){var t=this[0]||{};return t.nodeType===1&&gf(t).contains(n)},toggleClass:function(n,t){for(var i,u=0,f=String(n).split(/\s+/),e=typeof t=="boolean",r;i=f[u++];)r=e?t:!this.hasClass(i),this[r?"addClass":"removeClass"](i);return this},attr:function(n,t){return arguments.length===2?(this[0].setAttribute(n,t),this):this[0].getAttribute(n)},data:function(n,t){var r,i;n="data-"+df(n||"");switch(arguments.length){case 2:return this.attr(n,t),this;case 1:return r=this.attr(n),ne(r);case 0:return i={},w.forEach.call(this[0].attributes,function(t){t&&(n=t.name,n.indexOf("data-")||(n=ai(n.slice(5)),i[n]=ne(t.value)))}),i}},removeData:function(n){return n="data-"+df(n),this[0].removeAttribute(n),this},css:function(n,t){var i,r;if(avalon.isPlainObject(n))for(i in n)avalon.css(this,i,n[i]);else r=avalon.css(this,n,t);return r!==void 0?r:this},position:function(){var n,i,r=this[0],t={top:0,left:0};if(r)return this.css("position")==="fixed"?i=r.getBoundingClientRect():(n=this.offsetParent(),i=this.offset(),n[0].tagName!=="HTML"&&(t=n.offset()),t.top+=avalon.css(n[0],"borderTopWidth",!0),t.left+=avalon.css(n[0],"borderLeftWidth",!0),t.top-=n.scrollTop(),t.left-=n.scrollLeft()),{top:i.top-t.top-avalon.css(r,"marginTop",!0),left:i.left-t.left-avalon.css(r,"marginLeft",!0)}},offsetParent:function(){for(var n=this[0].offsetParent;n&&avalon.css(n,"position")==="static";)n=n.offsetParent;return avalon(n||v)},bind:function(n,t,i){if(this[0])return avalon.bind(this[0],n,t,i)},unbind:function(n,t,i){return this[0]&&avalon.unbind(this[0],n,t,i),this},val:function(n){var t=this[0],u;if(t&&t.nodeType===1){var i=arguments.length===0,f=i?":get":":set",r=vr[ch(t)+f];if(r)u=r(t,n);else{if(i)return(t.value||"").replace(/\r/g,"");t.value=n}}return i?u:this}});var nh=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,th=/^[\],:{}\s]*$/,ih=/(?:^|:|,)(?:\s*\[)+/g,rh=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,uh=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=n.JSON?JSON.parse:function(n){if(typeof n=="string"){if(n=n.trim(),n&&th.test(n.replace(rh,"@").replace(uh,"]").replace(ih,"")))return new Function("return "+n)();avalon.error("Invalid JSON: "+n)}return n};avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,t){avalon.fn[n]=function(i){var u=this[0]||{},r=fh(u),f=n==="scrollTop";if(arguments.length)r?r.scrollTo(f?avalon(r).scrollLeft():i,f?i:avalon(r).scrollTop()):u[n]=i;else return r?t in r?r[t]:v[n]:u[n]}});var o=avalon.cssHooks={},te=["","-webkit-","-o-","-moz-","-ms-"],cr={float:s?"cssFloat":"styleFloat"};if(avalon.cssNumber=ht("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(n,t,i){if(cr[n])return cr[n];t=t||v.style;for(var r=0,u=te.length;r<u;r++)if(i=ai(te[r]+n),i in t)return cr[n]=i;return null},o["@:set"]=function(n,t,i){try{n.style[t]=i}catch(r){}},n.getComputedStyle)o["@:get"]=function(n,t){if(!n||!n.style)throw new Error("getComputedStyle要求传入一个节点 "+n);var i,r=getComputedStyle(n,null);return r&&(i=t==="filter"?r.getPropertyValue(t):r[t],i===""&&(i=n.style[t])),i},o["opacity:get"]=function(n){var t=o["@:get"](n,"opacity");return t===""?"1":t};else{var eh=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,oh=/^(top|right|bottom|left)$/,ie=/alpha\([^)]*\)/i,lr=!!n.XDomainRequest,sh="DXImageTransform.Microsoft.Alpha",hh={thin:lr?"1px":"2px",medium:lr?"3px":"4px",thick:lr?"5px":"6px"};o["@:get"]=function(n,t){var u=n.currentStyle,i=u[t];if(eh.test(i)&&!oh.test(i)){var r=n.style,f=r.left,e=n.runtimeStyle.left;n.runtimeStyle.left=u.left;r.left=t==="fontSize"?"1em":i||0;i=r.pixelLeft+"px";r.left=f;n.runtimeStyle.left=e}return i==="medium"&&(t=t.replace("Width","Style"),u[t]==="none"&&(i="0px")),i===""?"auto":hh[i]||i};o["opacity:set"]=function(n,t,i){var r=n.style,f=isFinite(i)&&i<=1?"alpha(opacity="+i*100+")":"",u=r.filter||"";r.zoom=1;r.filter=(ie.test(u)?u.replace(ie,f):u+" "+f).trim();r.filter||r.removeAttribute("filter")};o["opacity:get"]=function(n){var t=n.filters.alpha||n.filters[sh],i=t&&t.enabled?t.opacity:100;return i/100+""}}"top,left".replace(l,function(n){o[n+":get"]=function(t){var i=o["@:get"](t,n);return/px$/.test(i)?i:avalon(t).position()[n]+"px"}});ar={position:"absolute",visibility:"hidden",display:"block"};re=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(l,function(n){var t=n.toLowerCase(),r="client"+n,u="scroll"+n,i="offset"+n;o[t+":get"]=function(t,r,u){var e=-4,f;return(typeof u=="number"&&(e=u),r=n==="Width"?["Left","Right"]:["Top","Bottom"],f=t[i],e===2)?f+avalon.css(t,"margin"+r[0],!0)+avalon.css(t,"margin"+r[1],!0):(e<0&&(f=f-avalon.css(t,"border"+r[0]+"Width",!0)-avalon.css(t,"border"+r[1]+"Width",!0)),e===-4&&(f=f-avalon.css(t,"padding"+r[0],!0)-avalon.css(t,"padding"+r[1],!0)),f)};o[t+"&get"]=function(n){var u=[],f,e,i,r;for(ue(n,u),f=o[t+":get"](n),e=0;i=u[e++];){n=i.node;for(r in i)typeof i[r]=="string"&&(n.style[r]=i[r])}return f};avalon.fn[t]=function(f){var e=this[0],s;return arguments.length===0?e.setTimeout?e["inner"+n]||e.document.documentElement[r]:e.nodeType===9?(s=e.documentElement,Math.max(e.body[u],s[u],e.body[i],s[i],s[r])):o[t+"&get"](e):this.css(t,f)};avalon.fn["inner"+n]=function(){return o[t+":get"](this[0],void 0,-2)};avalon.fn["outer"+n]=function(n){return o[t+":get"](this[0],void 0,n===!0?2:0)}});avalon.fn.offset=function(){var n=this[0],t={left:0,top:0};if(!n||!n.tagName||!n.ownerDocument)return t;var r=n.ownerDocument,u=r.body,i=r.documentElement,f=r.defaultView||r.parentWindow;if(!avalon.contains(i,n))return t;n.getBoundingClientRect&&(t=n.getBoundingClientRect());var e=i.clientTop||u.clientTop,o=i.clientLeft||u.clientLeft,s=Math.max(f.pageYOffset||0,i.scrollTop,u.scrollTop),h=Math.max(f.pageXOffset||0,i.scrollLeft,u.scrollLeft);return{top:t.top+s-e,left:t.left+h-o}};var lh=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,vr={"option:get":nt?function(n){return lh.test(n.outerHTML)?n.value:n.text.trim()}:function(n){return n.value},"select:get":function(n,t){for(var r,e=n.options,i=n.selectedIndex,h=vr["option:get"],u=n.type==="select-one"||i<0,o=u?null:[],s=u?i+1:e.length,f=i<0?s:u?i:0;f<s;f++)if(r=e[f],(r.selected||f===i)&&!r.disabled){if(t=h(r),u)return t;o.push(t)}return o},"select:set":function(n,t,i){var u,f,r;for(t=[].concat(t),u=vr["option:get"],f=0;r=n.options[f++];)(r.selected=t.indexOf(u(r))>-1)&&(i=!0);i||(n.selectedIndex=-1)}},ah={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},fe=n.JSON&&JSON.stringify||function(n){return'"'+n.replace(/[\\\"\x00-\x1f]/g,function(n){var t=ah[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"'},vh="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",yh=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,ph=/[^\w$]+/g,wh=new RegExp(["\\b"+vh.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),bh=/\b\d[^,]*/g,kh=/^,+|,+$/g,ee=new ei(512),dh=function(n){var t=","+n.trim(),i=ee.get(t),r;return i?i:(r=n.replace(yh,"").replace(ph,",").replace(wh,"").replace(bh,"").replace(kh,"").split(/^$|,+/),ee.put(t,oe(r)))};var yr=new ei(128),nc=/\w\[.*\]|\w\.\w/,tc=/(\$proxy\$[a-z]+)\d+$/,ic=/\)\s*$/,rc=/\)\s*\|/g,uc=/\|\s*([$\w]+)/g,fc=/"\s*\["/g,ec=/"\s*\(/g;avalon.parseExprProxy=tt;avalon.scan=function(n,t){n=n||v;var i=t?[].concat(t):[];ke(n,i)};he=ht("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase());bt=function(n,t,i){var r=n.getAttribute(t),f,u;if(r)for(f=0;u=i[f++];)if(u.hasOwnProperty(r)&&typeof u[r]=="function")return u[r]};var le=nt&&n.MutationObserver?function(n){for(var t=n.firstChild,i,r;t;)r=t.nextSibling,t.nodeType===3?i?(i.nodeValue+=t.nodeValue,n.removeChild(t)):i=t:i=null,t=r}:0,ae=/ms-(\w+)-?(.*)/,sc={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},hc=ht("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),cc=ht("value,title,alt,checked,selected,disabled,readonly,enabled");if(ye=/^if|widget|repeat$/,pe=/^each|with|html|include$/,!"1"[0])var we=new ei(512),ac=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,vc=/^['"]/,yc=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,pc=/&amp;/g,be=function(n){var i=n.outerHTML,f,s;if(i.slice(0,2)==="<\/"||!i.trim())return[];var r=i.match(yc)[0],e=[],h,u,t,o=we.get(r);if(o)return o;while(u=ac.exec(r))t=u[2],t&&(t=(vc.test(t)?t.slice(1,-1):t).replace(pc,"&")),f=u[1].toLowerCase(),h=f.match(ae),s={name:f,specified:!0,value:t||""},e.push(s);return we.put(r,e)};var de=/\|\s*html\s*/,kc=/\|\|/g,dc=/&lt;/g,gc=/&gt;/g,nl=/(['"])(\\\1|.)+?\1/g;no="autofocus,autoplay,async,allowTransparency,checked,controls,declare,disabled,defer,defaultChecked,defaultSelected,contentEditable,isMap,loop,multiple,noHref,noResize,noShade,open,readOnly,selected";dr={};no.replace(l,function(n){dr[n.toLowerCase()]=n});vi={"accept-charset":"acceptCharset",char:"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"};to="accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan,dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign";to.replace(l,function(n){vi[n.toLowerCase()]=n});var tl=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/img,il=/<noscript.*?>([\s\S]+?)<\/noscript>/im,gr=function(){return new(n.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},lt=avalon.templateCache={};e.attr=function(n,t){var u=n.value.trim(),f=!0,r,e;u.indexOf(rt)>-1&&u.indexOf(ut)>2&&(f=!1,ii.test(u)&&RegExp.rightContext===""&&RegExp.leftContext===""&&(f=!0,u=RegExp.$1));n.type==="include"&&(r=n.element,n.includeRendered=bt(r,"data-include-rendered",t),n.includeLoaded=bt(r,"data-include-loaded",t),e=n.includeReplace=!!avalon(r).data("includeReplace"),avalon(r).data("includeCache")&&(n.templateCache={}),n.startInclude=i.createComment("ms-include"),n.endInclude=i.createComment("ms-include-end"),e?(n.element=n.startInclude,r.parentNode.insertBefore(n.startInclude,r),r.parentNode.insertBefore(n.endInclude,r.nextSibling)):(r.insertBefore(n.startInclude,r.firstChild),r.appendChild(n.endInclude)));n.handlerName="attr";tt(u,t,n,f?0:kr(n.value))};b.attr=function(t,r,u){var h=u.type,e=u.param,p,w,d,f,o,l,y,b,k;if(h==="css")avalon(r).css(e,t);else if(h==="attr"){if(p=t===!1||t===null||t===void 0,!s&&vi[e]&&(e=vi[e]),w=dr[e],typeof r[w]=="boolean"&&(r[w]=!!t,t||(p=!0)),p)return r.removeAttribute(e);d=pi.test(r)?!1:i.namespaces&&kf(r)?!0:e in r.cloneNode(!1);d?r[e]=t:r.setAttribute(e,t)}else if(h==="include"&&t){var g=u.vmodels,nt=u.includeRendered,tt=u.includeLoaded,rt=u.includeReplace,c=rt?r.parentNode:r,a=function(n){var o,f,r,e,s,h;for(tt&&(o=tt.apply(c,[n].concat(g)),typeof o=="string"&&(n=o)),nt&&pr(c,function(){nt.call(c)},NaN),f=u.includeLastID,u.templateCache&&f&&f!==t&&(r=u.templateCache[f],r||(r=u.templateCache[f]=i.createElement("div"),st.appendChild(r))),u.includeLastID=t;;)if(e=u.startInclude.nextSibling,e&&e!==u.endInclude)c.removeChild(e),r&&r.appendChild(e);else break;s=rl(u,t,n);h=avalon.slice(s.childNodes);c.insertBefore(s,u.endInclude);ui(h,g)};if(u.param==="src")typeof lt[t]=="string"?avalon.nextTick(function(){a(lt[t])}):Array.isArray(lt[t])?lt[t].push(a):(f=gr(),f.onreadystatechange=function(){var n,i,r,u;if(f.readyState===4&&(n=f.status,n>=200&&n<300||n===304||n===1223)){for(i=f.responseText,r=0;u=lt[t][r++];)u(i);lt[t]=i}},lt[t]=[a],f.open("GET",t,!0),"withCredentials"in f&&(f.withCredentials=!0),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.send(null));else if(o=t&&t.nodeType===1?t:i.getElementById(t),o){if(o.tagName==="NOSCRIPT"&&!(o.innerHTML||o.fixIE78)){f=gr();f.open("GET",location,!1);f.send(null);var ut=i.getElementsByTagName("noscript"),it=(f.responseText||"").match(tl)||[],ft=it.length;for(l=0;l<ft;l++)y=ut[l],y&&(y.style.display="none",y.fixIE78=(it[l].match(il)||["","&nbsp;"])[1])}avalon.nextTick(function(){a(o.fixIE78||o.value||o.innerText||o.innerHTML)})}}else v.hasAttribute||typeof t!="string"||h!=="src"&&h!=="href"||(t=t.replace(/&amp;/g,"&")),r[h]=t,n.chrome&&r.tagName==="EMBED"&&(b=r.parentNode,k=document.createComment("ms-src"),b.replaceChild(k,r),b.replaceChild(r,k))};"title,alt,src,value,css,include,href".replace(l,function(n){e[n]=e.attr});e["class"]=function(n,t){var s=n.param,i=n.value,e,h,f,r,o;if(n.handlerName="class",!s||isFinite(s)){if(n.param="",h=i.replace(gu,function(n){return n.replace(/./g,"0")}),f=h.indexOf(":"),f===-1)r=i;else if(r=i.slice(0,f),e=i.slice(f+1),se(e,t,n),n.evaluator)n._evaluator=n.evaluator,n._args=n.args;else return u("debug: ms-class '"+(e||"").trim()+"' 不存在于VM中"),!1;o=ii.test(r);o||(n.immobileClass=r);tt("",t,n,o?kr(r):0)}else n.immobileClass=n.oldStyle=n.param,tt(i,t,n)};b["class"]=function(n,t,i){var r=avalon(t),e=i.type,u,f,o,s,h;if(e==="class"&&i.oldStyle)r.toggleClass(i.oldStyle,!!n);else{i.toggleClass=i._evaluator?!!i._evaluator.apply(t,i._args):!0;i.newClass=i.immobileClass||n;i.oldClass&&i.newClass!==i.oldClass&&r.removeClass(i.oldClass);i.oldClass=i.newClass;switch(e){case"class":r.toggleClass(i.newClass,i.toggleClass);break;case"hover":case"active":i.hasBindEvent||(u="mouseenter",f="mouseleave",e==="active"&&(t.tabIndex=t.tabIndex||-1,u="mousedown",f="mouseup",o=r.bind("mouseleave",function(){i.toggleClass&&r.removeClass(i.newClass)})),s=r.bind(u,function(){i.toggleClass&&r.addClass(i.newClass)}),h=r.bind(f,function(){i.toggleClass&&r.removeClass(i.newClass)}),i.rollback=function(){r.unbind("mouseleave",o);r.unbind(u,s);r.unbind(f,h)},i.hasBindEvent=!0)}}};"hover,active".replace(l,function(n){e[n]=e["class"]});b.data=function(n,t,i){var r="data-"+i.param;n&&typeof n=="object"?t[r]=n:t.setAttribute(r,String(n))};at=e.duplex=function(n,t){var i=n.element,e,r,o,s,c,l,f;if(tt(n.value,t,n,0,1),n.changed=bt(i,"data-duplex-changed",t)||h,n.evaluator&&n.args){r=[];o=ht("string,number,boolean,checked");i.type==="radio"&&n.param===""&&(n.param="checked");i.msData&&(i.msData["ms-duplex"]=n.value);n.param.replace(/\w+/g,function(t){/^(checkbox|radio)$/.test(i.type)&&/^(radio|checked)$/.test(t)&&(t==="radio"&&u("ms-duplex-radio已经更名为ms-duplex-checked"),t="checked",n.isChecked=!0);t==="bool"?(t="boolean",u("ms-duplex-bool已经更名为ms-duplex-boolean")):t==="text"&&(t="string",u("ms-duplex-text已经更名为ms-duplex-string"));o[t]&&(e=!0);avalon.Array.ensure(r,t)});e||r.push("string");n.param=r.join("-");n.bound=function(t,r){i.addEventListener?i.addEventListener(t,r,!1):i.attachEvent("on"+t,r);var u=n.rollback;n.rollback=function(){i.avalonSetter=null;avalon.unbind(i,t,r);u&&u()}};for(s in avalon.vmodels)c=avalon.vmodels[s],c.$fire("avalon-ms-duplex-init",n);l=n.pipe||(n.pipe=ul);l(null,n,"init");f=i.tagName;at[f]&&at[f](i,n.evaluator.apply(null,n.args),n)}};avalon.duplexHooks={checked:{get:function(n,t){return!t.element.oldValue}},string:{get:function(n){return n},set:nu},boolean:{get:function(n){return n==="true"},set:nu},number:{get:function(n,t){var i=parseFloat(n),r;if(-n==-i)return i;r=/strong|medium|weak/.exec(t.element.getAttribute("data-duplex-number"))||["medium"];switch(r[0]){case"strong":return 0;case"medium":return n===""?"":0;case"weak":return n}},set:nu}};kt=[];avalon.tick=function(n){kt.push(n)===1&&(io=setInterval(fl,60))};tu=h;iu=/text|password|hidden/,new function(){var u;try{var n={},t=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype;function r(t){if(avalon.contains(v,this)){if(n[this.tagName].call(this,t),!iu.test(this.type))return;!this.msFocus&&this.avalonSetter&&this.avalonSetter()}}u=HTMLInputElement.prototype;Object.getOwnPropertyNames(u);n.INPUT=Object.getOwnPropertyDescriptor(t,"value").set;Object.defineProperty(t,"value",{set:r});n.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set;Object.defineProperty(i,"value",{set:r})}catch(f){tu=avalon.tick}};nt&&avalon.bind(i,"selectionchange",function(){var n=i.activeElement;n&&typeof n.avalonSetter=="function"&&n.avalonSetter()});at.INPUT=function(n,t,i){function o(n){i.changed.call(this,n,i)}function p(){c=!0}function w(){c=!1}var h=n.type,r=i.bound,e=avalon(n),c=!1,f=function(){if(!c){var u=n.oldValue=n.value,r=i.pipe(u,i,"get");e.data("duplexObserve")!==!1&&(t(r),o.call(n,r),e.data("duplex-focus")&&avalon.nextTick(function(){n.focus()}))}},a,y;if(i.handler=function(){var r=i.pipe(t(),i,"set")+"";r!==n.oldValue&&(n.value=r)},i.isChecked||h==="radio")a=nt===6,f=function(){if(e.data("duplexObserve")!==!1){var r=i.pipe(n.value,i,"get");t(r);o.call(n,r)}},i.handler=function(){var u=t(),r=i.isChecked?!!u:u+""===n.value;n.oldValue=r;a?setTimeout(function(){n.defaultChecked=r;n.checked=r},31):n.checked=r},r("click",f);else if(h==="checkbox")f=function(){if(e.data("duplexObserve")!==!1){var f=n.checked?"ensure":"remove",r=t();Array.isArray(r)||(u("ms-duplex应用于checkbox上要对应一个数组"),r=[r]);avalon.Array[f](r,i.pipe(n.value,i,"get"));o.call(n,r)}},i.handler=function(){var r=[].concat(t());n.checked=r.indexOf(i.pipe(n.value,i,"get"))>-1},r(s?"change":"click",f);else{y=n.getAttribute("data-duplex-event")||"input";n.attributes["data-event"]&&u("data-event指令已经废弃，请改用data-duplex-event");function b(n){setTimeout(function(){f(n)})}y.replace(l,function(n){switch(n){case"input":nt?(nt>8?r("input",f):r("propertychange",function(n){n.propertyName==="value"&&f()}),r("dragend",b)):(r("input",f),r("compositionstart",p),r("compositionend",w),r("DOMAutoComplete",f));break;default:r(n,f)}});r("focus",function(){n.msFocus=!0});r("blur",function(){n.msFocus=!1});iu.test(h)&&tu(function(){if(v.contains(n))n.msFocus||n.oldValue===n.value||f();else if(!n.msRetain)return!1});n.avalonSetter=f}n.oldValue=n.value;avalon.injectBinding(i);o.call(n,n.value)};at.TEXTAREA=at.INPUT;at.SELECT=function(n,t,i){function f(){if(r.data("duplexObserve")!==!1){var u=r.val();u=Array.isArray(u)?u.map(function(n){return i.pipe(n,i,"get")}):i.pipe(u,i,"get");u+""!==n.oldValue&&t(u);i.changed.call(n,u,i)}}var r=avalon(n);i.handler=function(){var i=t();i=i&&i.$model||i;Array.isArray(i)?n.multiple||u("ms-duplex在<select multiple=true>上要求对应一个数组"):n.multiple&&u("ms-duplex在<select multiple=false>不能对应一个数组");i=Array.isArray(i)?i.map(String):i+"";i+""!==n.oldValue&&(r.val(i),n.oldValue=i+"")};i.bound("change",f);n.msCallback=function(){avalon.injectBinding(i);i.changed.call(n,t(),i)}};b.html=function(n,t,r){var h=t.nodeType!==1,f=h?t.parentNode:t,s,u,e,c,o;if(f){if(n=n==null?"":n,t.nodeType===3&&(s=d("html"),f.insertBefore(i.createComment(s),t),r.element=i.createComment(s+":end"),f.replaceChild(r.element,t),t=r.element),typeof n!="object")u=avalon.parseHTML(String(n));else if(n.nodeType===11)u=n;else if(n.nodeType===1||n.item)for(e=n.nodeType===1?n.childNodes:n.item,u=yt.cloneNode(!0);e[0];)u.appendChild(e[0]);if(e=avalon.slice(u.childNodes),h){for(c=t.nodeValue.slice(0,-4);;)if(o=t.previousSibling,o&&(o.nodeType!==8||o.nodeValue!==c))f.removeChild(o);else break;f.insertBefore(u,t)}else avalon.clearHTML(t).appendChild(u);ui(e,r.vmodels)}};e["if"]=e.data=e.text=e.html=function(n,t){tt(n.value,t,n)};b["if"]=function(n,t,r){try{if(!t.parentNode)return}catch(f){return}if(n)t.nodeType===8&&(t.parentNode.replaceChild(r.template,t),t=r.element=r.template),t.getAttribute(r.name)&&(t.removeAttribute(r.name),ve(t,r.vmodels)),r.rollback=null;else if(t.nodeType===1){var u=r.element=i.createComment("ms-if");t.parentNode.replaceChild(u,t);r.template=t;st.appendChild(t);r.rollback=function(){t.parentNode===st&&st.removeChild(t)}}};ru=/\(([^)]*)\)/bindingHandlers.on=function(n,t){var i=n.value,r,u;n.type="on";r=n.param.replace(/-\d+$/,"");typeof e.on[r+"Hook"]=="function"&&e.on[r+"Hook"](n);i.indexOf("(")>0&&i.indexOf(")")>-1&&(u=(i.match(ru)||["",""])[1].trim(),(u===""||u==="$event")&&(i=i.replace(ru,"")));tt(i,t,n)};b.on=function(n,t,i){var r,u;n=function(n){var t=i.evaluator||h;return t.apply(this,i.args.concat(n))};r=i.param.replace(/-\d+$/,"");r==="scan"?n.call(t,{type:r}):typeof i.specialBind=="function"?i.specialBind(t,n):u=avalon.bind(t,r,n);i.rollback=function(){typeof i.specialUnbind=="function"?i.specialUnbind():avalon.unbind(t,r,u)}};e.repeat=function(n,t){var o=n.type,s,r,h,c,v,f,e,l,u,y,a,p,w,nt,g,it,rt;tt(n.value,t,n,0,1);s=!1;try{r=n.$repeat=n.evaluator.apply(0,n.args||[]);h=avalon.type(r);h!=="object"&&h!=="array"&&(s=!0,avalon.log("warning:"+n.value+"只能是对象或数组"))}catch(ut){s=!0}if(c=n.value.split(".")||[],c.length>1)for(c.pop(),v=c[0],f=0;e=t[f++];)if(e&&e.hasOwnProperty(v)){l=e[v].$events||{};l[k]=l[k]||[];l[k].push(n);break}if(u=n.element,u.removeAttribute(n.name),n.sortedCallback=bt(u,"data-with-sorted",t),n.renderedCallback=bt(u,"data-"+o+"-rendered",t),y=d(o),a=n.element=i.createComment(y+":end"),n.clone=i.createComment(y),yt.appendChild(a),o==="each"||o==="with"?(n.template=u.innerHTML.trim(),avalon.clearHTML(u).appendChild(a)):(n.template=u.outerHTML.trim(),u.parentNode.replaceChild(a,u)),n.template=avalon.parseHTML(n.template),n.handler=b.repeat,n.rollback=function(){var i=n.element,t;if(i){n.handler("clear");var r=i.parentNode,u=n.template,f=u.firstChild;r.replaceChild(u,i);t=n.$with;t&&t.parentNode&&t.parentNode.removeChild(t);f=n.element=n.type==="repeat"?f:r}},!s){if(n.$outer={},p="$key",w="$val",Array.isArray(r)){if(!r.$map){for(r.$map={el:1},nt=r.length,g=[],f=0;f<nt;f++)g.push(hf(f,r));r.$proxy=g}r.$map[n.param||"el"]=1;p="$first";w="$last"}for(f=0;e=t[f++];)if(e.hasOwnProperty(p)&&e.hasOwnProperty(w)){n.$outer=e;break}it=r.$events;rt=(it||{})[k];or(rt,n);h==="object"?(n.$with=!0,r.$proxy||(r.$proxy={}),n.handler("append",r)):r.length&&n.handler("add",0,r.length)}};b.repeat=function(n,t,i){var o,d,r,w,tt,it,rt;if(n){var u=this,c,e,s=u.element,v=el(u),f=s.parentNode,l=yt.cloneNode(!1);switch(n){case"add":var ut=t+i,y=[],ft=u.$repeat;for(o=t;o<ut;o++)d=ft.$proxy[o],d.$outer=u.$outer,ro(u,l,d,y);for(f.insertBefore(l,v[t]||s),o=0;e=y[o++];)ui(e.nodes,e.vmodels),e.nodes=e.vmodels=null;break;case"del":uu(v[t],v[t+i]||s);break;case"clear":c=v[0];c&&uu(c,s);break;case"move":if(c=v[0],c){var et=c.nodeValue,g=[],p=[],nt;for(uu(c,s,function(){p.unshift(this);this.nodeValue===et&&(g.unshift(p),p=[])}),er(g,t);p=g.shift();)while(nt=p.shift())l.appendChild(nt);f.insertBefore(l,s)}break;case"append":var b=t,a=b.$proxy,k=[];y=[];for(r in a)b.hasOwnProperty(r)||(fo(a[r],fu),delete a[r]);for(r in b)b.hasOwnProperty(r)&&r!=="hasOwnProperty"&&r!=="$proxy"&&k.push(r);for(u.sortedCallback&&(w=u.sortedCallback.call(f,k),w&&Array.isArray(w)&&w.length&&(k=w)),o=0;r=k[o++];)r!=="hasOwnProperty"&&(a[r]=sl(a[r],r,u),ro(u,l,a[r],y));for(tt=u.$with=u.clone,f.insertBefore(tt,s),f.insertBefore(l,s),o=0;e=y[o++];)ui(e.nodes,e.vmodels),e.nodes=e.vmodels=null}n==="clear"&&(n="del");it=u.renderedCallback||h;rt=arguments;pr(f,function(){it.apply(f,rt);f.oldValue&&f.tagName==="SELECT"&&avalon(f).val(f.oldValue.split(","))},NaN)}};"with,each".replace(l,function(n){e[n]=e.repeat});avalon.pool=li;fu=[];b.text=function(n,t){if(n=n==null?"":n,t.nodeType===3)try{t.data=n}catch(i){}else"textContent"in t?t.textContent=n:t.innerText=n};avalon.parseDisplay=fi;e.visible=function(n,t){var i=avalon(n.element),r=i.css("display");if(r==="none"){var u=i[0].style,f=/visibility/i.test(u.cssText),e=i.css("visibility");u.display="";u.visibility="hidden";r=i.css("display");r==="none"&&(r=fi(i[0].nodeName));u.visibility=f?e:""}n.display=r;tt(n.value,t,n)};b.visible=function(n,t,i){t.style.display=n?i.display:"none"};e.widget=function(t,i){var p=t.value.match(l),r=t.element,e=p[0],o=p[1],c,a,b,v,s,w,k,y,f;if(o&&o!=="$"||(o=d(e)),c=p[2]||e,a=avalon.ui[e],typeof a=="function"){for(i=r.vmodels||i,b=0;v=i[b++];)if(v.hasOwnProperty(c)&&typeof v[c]=="object"){s=v[c];s=s.$model||s;break}if(s&&(w=s[e+"Id"],typeof w=="string"&&(u("warning!不再支持"+e+"Id"),o=w)),k=avalon.getWidgetData(r,e),t.value=[e,o,c].join(","),t[e+"Id"]=o,t.evaluator=h,r.msData["ms-widget-id"]=o,y=t[e+"Options"]=avalon.mix({},a.defaults,s||{},k),r.removeAttribute("ms-widget"),f=a(r,t,i)||{},f.$id){avalon.vmodels[o]=f;ce(r,f);try{f.$init(function(){avalon.scan(r,[f].concat(i));typeof y.onInit=="function"&&y.onInit.call(r,f,y,i)})}catch(g){}t.rollback=function(){try{f.widgetElement=null;f.$remove()}catch(n){}r.msData={};delete avalon.vmodels[f.$id]};yf(t,hl);n.chrome&&r.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(pf)})}else avalon.scan(r,i)}else i.length&&(r.vmodels=i)};var hl=[],cl=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,ll=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,al=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/ig,vl={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/ig,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/ig,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/ig},yl=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,pl=/([^\#-~| |!])/g;if(eu=avalon.filters={uppercase:function(n){return n.toUpperCase()},lowercase:function(n){return n.toLowerCase()},truncate:function(n,t,i){return t=t||30,i=typeof i=="string"?i:"...",n.length>t?n.slice(0,t-i.length)+i:String(n)},$filter:function(n){for(var i,r,f,t=1,u=arguments.length;t<u;t++)i=arguments[t],r=avalon.filters[i.shift()],typeof r=="function"&&(f=[n].concat(i),n=r.apply(null,f));return n},camelize:ai,sanitize:function(n){return n.replace(cl,"").replace(al,function(n){var i=n.toLowerCase().match(/<(\w+)\s/),t;return i&&(t=vl[i[1]],t&&(n=n.replace(t,function(n,t,i){var r=i.charAt(0);return t+"="+r+"javascript:void(0)"+r}))),n.replace(ll," ").replace(/\s+/g," ")})},escape:function(n){return String(n).replace(/&/g,"&amp;").replace(yl,function(n){var t=n.charCodeAt(0),i=n.charCodeAt(1);return"&#"+((t-55296)*1024+(i-56320)+65536)+";"}).replace(pl,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(n,t,i){return(t||"￥")+eo(n,isFinite(i)?i:2)},number:eo},new function(){function t(n){return parseInt(n,10)||0}function r(n,t,i){var r="";for(n<0&&(r="-",n=-n),n=""+n;n.length<t;)n="0"+n;return i&&(n=n.substr(n.length-t)),r+n}function n(n,t,i,u){return function(f){var e=f["get"+n]();return(i>0||e>-i)&&(e+=i),e===0&&i===-12&&(e=12),r(e,t,u)}}function i(n,t){return function(i,r){var u=i["get"+n](),f=(t?"SHORT"+n:n).toUpperCase();return r[f][u]}}function f(n){var t=-1*n.getTimezoneOffset(),i=t>=0?"+":"";return i+(r(Math[t>0?"floor":"ceil"](t/60),2)+r(Math.abs(t%60),2))}function e(n,t){return n.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}var o={yyyy:n("FullYear",4),yy:n("FullYear",2,0,!0),y:n("FullYear",1),MMMM:i("Month"),MMM:i("Month",!0),MM:n("Month",2,1),M:n("Month",1,1),dd:n("Date",2),d:n("Date",1),HH:n("Hours",2),H:n("Hours",1),hh:n("Hours",2,-12),h:n("Hours",1,-12),mm:n("Minutes",2),m:n("Minutes",1),ss:n("Seconds",2),s:n("Seconds",1),sss:n("Milliseconds",3),EEEE:i("Day"),EEE:i("Day",!0),a:e,Z:f},s=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,h=/^\/Date\((\d+)\)\/$/filters.date=function(n,i){var w=eu.date.locate,b="",e=[],c,l,a,v,y,p;if(i=i||"mediumDate",i=w[i]||i,typeof n=="string")if(/^\d+$/.test(n))n=t(n);else if(h.test(n))n=+RegExp.$1;else{var f=n.trim(),r=[0,0,0,0,0,0,0],u=new Date(0);f=f.replace(/^(\d+)\D(\d+)\D(\d+)/,function(n,i,u,f){var e=f.length===4?[f,i,u]:[i,u,f];return r[0]=t(e[0]),r[1]=t(e[1])-1,r[2]=t(e[2]),""});a=u.setFullYear;v=u.setHours;f=f.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(n,i,u,f,e){return r[3]=t(i),r[4]=t(u),r[5]=t(f),e&&(r[6]=Math.round(parseFloat("0."+e)*1e3)),""});y=0;p=0;f=f.replace(/Z|([+-])(\d\d):?(\d\d)/,function(n,i,r,f){return a=u.setUTCFullYear,v=u.setUTCHours,i&&(y=t(i+r),p=t(i+f)),""});r[3]-=y;r[4]-=p;a.apply(u,r.slice(0,3));v.apply(u,r.slice(3));n=u}if(typeof n=="number"&&(n=new Date(n)),avalon.type(n)==="date"){while(i)l=s.exec(i),l?(e=e.concat(l.slice(1)),i=e.pop()):(e.push(i),i=null);return e.forEach(function(t){c=o[t];b+=c?c(n,w):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),b}},u={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{"0":"周日","1":"周一","2":"周二","3":"周三","4":"周四","5":"周五","6":"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss",short:"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};u.SHORTMONTH=u.MONTH;eu.date.locate=u},f=avalon.modules={"domReady!":{exports:avalon,state:3},avalon:{exports:avalon,state:4}},f.exports=f.avalon,new function(){function st(n,t){var i="js",f,r,e,o;return n=n.replace(/^(\w+)\!/,function(n,t){return i=t,""}),i==="ready"&&(u("debug: ready!已经被废弃，请使用domReady!"),i="domReady"),f="",n=n.replace(nt,function(n){return f=n,""}),r="."+i,e=/js|css/.test(r)?r:"",n=n.replace(/\.[a-z0-9]+$/g,function(n){return n===r?(e=n,""):n}),o=avalon.mix({query:f,ext:e,res:i,name:n,toUrl:ii},t),o.toUrl(n),o}function dt(n){var i=n.name,u=n.res,t=f[i],r=i&&n.urlNoQuery,o;return t&&t.state>=1?i:(t=f[r],t&&t.state>=3)?(c(t.deps||[],t.factory,r),r):(i&&!t&&(t=f[r]={id:r,state:1},o=function(r){l[u]=r;r.load(i,n,function(n){arguments.length&&n!==void 0&&(t.exports=n);t.state=4;e()})},l[u]?o(l[u]):c([u],o)),i?r:u+"!")}function at(n,t){for(var r=0,i;i=n[r++];)if(f[i].state!==4&&(i===t||at(f[i].deps,t)))return!0}function vt(n,t,i){var r=v(n.src);if(n.onload=n.onreadystatechange=n.onerror=null,t||i&&f[r]&&!f[r].state)setTimeout(function(){p.removeChild(n);n=null}),u("debug: 加载 "+r+" 失败"+t+" "+!f[r].state);else return!0}function e(){var i,o,n,r,u,s;n:for(i=t.length;o=t[--i];)if(n=f[o],r=n.deps,r){for(u=0;s=r[u];u++)if(Object(f[s]).state!==4)continue n;n.state!==4&&(t.splice(i,1),ti(n.id,n.deps,n.factory),e())}}function g(n,r,f){function h(){var i=ot.pop();i&&i.require(r);f&&f();vt(o,!1,!s)&&(u("debug: 已成功加载 "+n),r&&t.push(r),e())}var o=i.createElement("script"),s,l,c,a;o.className=k;s="onload"in o;l=s?"onload":"onreadystatechange";c=0;o[l]=s?h:function(){yt.test(o.readyState)&&(++c,c===1?a=setTimeout(h,500):(clearTimeout(a),h()))};o.onerror=function(){vt(o,!0)};p.insertBefore(o,p.firstChild);o.src=n;u("debug: 正准备加载 "+n)}function v(n){return(n||"").replace(nt,"")}function pt(n){return/^(?:[a-z]+:)?\/\//i.test(String(n))}function tt(n,t){return"1"[0]?n[t]:n.getAttribute(t,4)}function ni(){var t,r,f,i,e;try{a.b.c()}catch(u){t=u.stack;!t&&n.opera&&(t=(String(u).match(/of linked script \S+/g)||[]).join(" "))}if(t)return t=t.split(/[@ ]/g).pop(),t=t[0]==="("?t.slice(1,-1):t.replace(/\s/,""),v(t.replace(/(:\d+)?:\d+$/i,""));for(r=p.getElementsByTagName("script"),f=r.length;i=r[--f];)if(i.className===k&&i.readyState==="interactive")return e=tt(i,"src"),i.className=v(e)}function ti(t,i,r){var e=Object(f[t]),c,o,h,l,s;for(e.state=4,c=0,o=[];h=i[c++];)h==="exports"?(l=e.exports||(e.exports={}),o.push(l)):o.push(f[h].exports);try{s=r.apply(n,o)}catch(a){u("执行["+t+"]模块的factory抛错： "+a)}return s!==void 0&&(e.exports=s),wt.test(t)&&delete f[t],delete e.factory,s}function ii(n){var i,s;n.indexOf(this.res+"!")===0&&(n=n.slice(this.res.length+1));var t=n,f=0,e=this.baseUrl,u=this.parentUrl||e;return o(n,r.paths,function(n,i){t=t.replace(i,n);f=1}),f||o(n,r.packages,function(n,i,r){t=t.replace(r.name,r.location)}),this.mapUrl&&o(this.mapUrl,r.map,function(n){o(t,n,function(n,i){t=t.replace(i,n);u=e})}),i=this.ext,i&&f&&t.slice(-i.length)===i&&(t=t.slice(0,-i.length)),pt(t)||(u=this.built||/^\w/.test(t)?e:u,t=kt(u,t)),s=t+i,t=s+this.query,o(n,r.urlArgs,function(n){t+=(t.indexOf("?")===-1?"?":"&")+n}),this.url=t,this.urlNoQuery=s}function y(n,t,i){var r=ui(n,t,i);return r.sort(fi),r}function bt(n){return new RegExp("^"+n+"(/|$)")}function ri(t){return function(){var i;return t.init&&(i=t.init.apply(n,arguments)),i||t.exports&&ei(t.exports)}}function ui(n,t,i){var f=[],r,u;for(r in n)it.call(n,r)&&(u={name:r,val:n[r]},f.push(u),u.reg=r==="*"&&t?/^/:bt(r),i&&r!=="*"&&(u.reg=new RegExp("/"+r.replace(/^\//,"")+"(/|$)")));return f}function o(n,t,i){t=t||[];for(var u=0,r;r=t[u++];)if(r.reg.test(n))return i(r.val,r.name,r),!1}function fi(n,t){var i=n.name,r=t.name;return r==="*"?-1:i==="*"?1:r.length-i.length}function kt(n,t){if(n.charAt(n.length-1)!=="/"&&(n+="/"),t.slice(0,2)==="./")return n+t.slice(2);if(t.slice(0,2)===".."){for(n+=t;rt.test(n);)n=n.replace(rt,"");return n}return t.slice(0,1)==="/"?n+t.slice(1):n+t}function ei(t){if(!t)return t;var i=n;return t.split(".").forEach(function(n){i=i[n]}),i}var t=[],ot=[],s=/\.js$/i,b=[],d=!1,yt,l,nt,wt,rt,ut,ft,w,et;c=avalon.require=function(n,i,u,o){var y,p,v,g,a;if(!d){if(b.push(avalon.slice(arguments)),arguments.length<=2)for(d=!0,y=b.splice(0,b.length);p=y.shift();)c.apply(null,p);return}Array.isArray(n)||avalon.error("require方法的第一个参数应为数组 "+n);var w=[],k={},l=u||"callback"+setTimeout("1");o=o||{};o.baseUrl=r.baseUrl;v=!!o.built;u&&(o.parentUrl=u.substr(0,u.lastIndexOf("/")),o.mapUrl=u.replace(s,""));v?(g=st(o.defineName,o),l=g.urlNoQuery):n.forEach(function(n){var i=st(n,o),t=dt(i);t&&(k[t]||(w.push(t),k[t]="司徒正美"))});a=f[l];a&&a.state===4||(f[l]={id:l,deps:v?n.concat():w,factory:i||h,state:3});a||t.push(l);e()};c.define=function(n,t,i){var u,e,r,o;typeof n!="string"&&(i=t,t=n,n="anonymous");Array.isArray(t)||(i=t,t=[]);u={built:!d,defineName:n};e=[t,i,u];i.require=function(n){if(e.splice(2,0,n),f[n]){f[n].state=3;var t=!1;try{t=at(f[n].deps,n)}catch(r){}t&&avalon.error(n+"模块与之前的模块存在循环依赖，请不要直接用script标签引入"+n+"模块")}delete i.require;c.apply(null,e)};r=u.built?"unknown":ni();r?(o=f[r],o&&(o.state=2),i.require(r)):ot.push(i)};c.config=r;c.define.amd=f;var ht=r["orig.paths"]={},ct=r["orig.map"]={},gt=r.packages=[],lt=r["orig.args"]={};avalon.mix(oi,{paths:function(n){avalon.mix(ht,n);r.paths=y(ht)},map:function(n){avalon.mix(ct,n);var t=y(ct,1,1);avalon.each(t,function(n,t){t.val=y(t.val)});r.map=t},packages:function(n){var f,e,o,t,i,u;for(n=n.concat(gt),f={},e=[],o=0;t=n[o++];)t=typeof t=="string"?{name:t}:t,i=t.name,f[i]||(u=kt(t.location||i,t.main||"main"),u=u.replace(s,""),e.push(t),f[i]=t.location=u,t.reg=bt(i));r.packages=e.sort()},urlArgs:function(n){typeof n=="string"&&(n={"*":n});avalon.mix(lt,n);r.urlArgs=y(lt,1)},baseUrl:function(n){var t,u;pt(n)||(t=p.getElementsByTagName("base")[0],t&&p.removeChild(t),u=i.createElement("a"),u.href=n,n=tt(u,"href"),t&&p.insertBefore(t,p.firstChild));n.length>3&&(r.baseUrl=n)},shim:function(n){var i,t;for(i in n)t=n[i],Array.isArray(t)&&(t=n[i]={deps:t}),!t.exportsFn&&(t.exports||t.init)&&(t.exportsFn=ri(t));r.shim=n}});yt=/complete|loaded/;l=c.plugins={ready:{load:h},js:{load:function(n,t,i){var f=t.url,e=t.urlNoQuery,u=r.shim[n.replace(s,"")];u?c(u.deps||[],function(){var n=avalon.slice(arguments);g(f,e,function(){i(u.exportsFn?u.exportsFn.apply(0,n):void 0)})}):g(f,e)}},css:{load:function(n,t,r){var e=t.url,f=i.createElement("link");f.rel="stylesheet";f.href=e;p.insertBefore(f,p.firstChild);u("debug: 已成功加载 "+e);r()}},text:{load:function(n,t,i){var f=t.url,r=gr(),e,o;r.onreadystatechange=function(){if(r.readyState===4){var n=r.status;n>399&&n<600?avalon.error(f+" 对应资源不存在或没有开启 CORS"):(u("debug: 已成功加载 "+f),i(r.responseText))}};e="_="+(new Date-0);o=f.indexOf("?")===-1?f+"?"+e:f+"&"+e;r.open("GET",o,!0);"withCredentials"in r&&(r.withCredentials=!0);r.setRequestHeader("X-Requested-With","XMLHttpRequest");r.send();u("debug: 正准备加载 "+f)}}};c.checkDeps=e;nt=/(\?[^#]*)$/;wt=/^callback\d+$/;rt=/\/\w+\/\.\./;ut=i.scripts[i.scripts.length-1];ft=ut.getAttribute("data-main");ft?(oi.baseUrl(ft),w=r.baseUrl,r.baseUrl=w.slice(0,w.lastIndexOf("/")+1),g(w.replace(s,"")+".js")):(et=v(tt(ut,"src")),r.baseUrl=et.slice(0,et.lastIndexOf("/")+1))},ou=[],dt=function(n){for(oo=!0,c&&(f["domReady!"].state=4,c.checkDeps());n=ou.shift();)n(avalon)},i.readyState==="complete")setTimeout(dt);else if(s)i.addEventListener("DOMContentLoaded",dt);else{i.attachEvent("onreadystatechange",function(){i.readyState==="complete"&&dt()});try{ho=n.frameElement===null}catch(wl){}v.doScroll&&ho&&n.external&&so()}return avalon.bind(n,"load",dt),avalon.ready=function(n){oo?n(avalon):ou.push(n)},avalon.config({loader:!0}),avalon.ready(function(){avalon.scan(i.body)}),typeof define=="function"&&define.amd&&define("avalon",[],function(){return avalon}),co=n.avalon,avalon.noConflict=function(t){return t&&n.avalon===avalon&&(n.avalon=co),avalon},t===void 0&&(n.avalon=avalon),avalon});
//# sourceMappingURL=avalon.min.js.map
